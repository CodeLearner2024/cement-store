{% for item in cart_items %}
<div class="row align-items-center p-3 border-bottom cart-item" data-item-id="{{ item.id }}">
    <!-- Image et nom du produit -->
    <div class="col-md-5 mb-3 mb-md-0">
        <div class="d-flex align-items-center">
            <a href="{{ item.product.get_absolute_url }}" class="me-3" style="width: 80px;">
                <img src="{{ item.product.image.url|default:'https://via.placeholder.com/80' }}" 
                     alt="{{ item.product.name }}" 
                     class="img-fluid rounded"
                     style="max-height: 80px; object-fit: contain;">
            </a>
            <div>
                <h6 class="mb-1">
                    <a href="{{ item.product.get_absolute_url }}" class="text-dark text-decoration-none">
                        {{ item.product.name }}
                    </a>
                </h6>
                <p class="small text-muted mb-1">
                    {% if item.variant %}
                        {{ item.variant.name }}
                    {% else %}
                        {{ item.product.category }}
                    {% endif %}
                </p>
                <form action="{% url 'boutique:remove_from_cart' item_id=item.id %}" 
                      method="post" 
                      class="remove-item-form d-inline">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-link text-danger p-0" style="font-size: 0.8rem;">
                        <i class="far fa-trash-alt me-1"></i>Supprimer
                    </button>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Prix unitaire -->
    <div class="col-md-2 text-center mb-3 mb-md-0">
        <div class="d-md-none small text-muted">Prix unitaire</div>
        <div>
            {% if item.get_discounted_price < item.product.price %}
                <span class="text-danger">{{ item.get_discounted_price }} BIF</span>
                <small class="text-decoration-line-through text-muted d-block">{{ item.product.price }} BIF</small>
            {% else %}
                {{ item.product.price }} BIF
            {% endif %}
        </div>
    </div>
    
    <!-- QuantitÃ© -->
    <div class="col-md-3 mb-3 mb-md-0">
        <div class="d-flex align-items-center justify-content-center">
            <form action="{% url 'boutique:update_cart_item' item_id=item.id %}" 
                  method="post" 
                  class="update-quantity-form" 
                  style="max-width: 150px;">
                {% csrf_token %}
                <div class="input-group">
                    <button type="button" class="btn btn-outline-secondary btn-sm quantity-decrease">
                        <i class="fas fa-minus"></i>
                    </button>
                    <input type="number" 
                           name="quantity" 
                           class="form-control form-control-sm text-center quantity-input" 
                           value="{{ item.quantity }}" 
                           min="1" 
                           max="{{ item.product.stock|default:99 }}">
                    <button type="button" class="btn btn-outline-secondary btn-sm quantity-increase">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Prix total -->
    <div class="col-md-2 text-end">
        <div class="d-md-none small text-muted">Total</div>
        <strong class="item-total">{{ item.total_price }} BIF</strong>
    </div>
</div>
{% endfor %}
